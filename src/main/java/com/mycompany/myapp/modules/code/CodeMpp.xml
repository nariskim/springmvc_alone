<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mycompany.myapp.modules.code.CodeMpp">

	<resultMap id="resultMapObj"
		type="com.mycompany.myapp.modules.code.Code"></resultMap>

	<sql id="selectCommon">


		FROM
		oyCodeGroup a

		WHERE 1=1
		<choose>
			<when test="scOycgDelNy == 1">AND a.oycgDelNy = 1</when>
			<when test="scOycgDelNy == 0">AND a.oycgDelNy = 0</when>
		</choose>
		<if test="scOycgName != null and !scOycgName.equals('')"> AND a.oycgName LIKE concat('%',#{scOycgName},'%')</if>
		<choose>
			<when test="scOption == 1">AND a.oycgName LIKE concat('%',#{scValue},'%')</when>
			<when test="scOption == 2">AND a.oycgNameEng LIKE concat('%',#{scValue},'%')</when>
		</choose>

	</sql>
	
	<select id="selectOneCount" resultType="Integer">

		SELECT
		count(*)
		<include refid="selectCommon" />
	</select>
	
	
	<select id="selectListGroup" resultMap="resultMapObj">
		SELECT
		a.oycgSeq
		, a.oycgName
		, a.oycgNameEng
		, a.oycgDelNy
		
		<include refid="selectCommon" />
		limit #{startRnumForMysql}, #{rowNumToShow}

	</select>


	



	<!-- <select id="selectListGroup" resultMap="resultMapObj">

		SELECT
		a.oycgSeq
		, a.oycgName
		, a.oycgNameEng
		, a.oycgDelNy

		FROM
		oyCodeGroup a

		WHERE 1=1
		<choose>
			<when test="scOycgDelNy == 1">AND a.oycgDelNy = 1</when>
			<when test="scOycgDelNy == 0">AND a.oycgDelNy = 0</when>
		</choose>
		<if test="scOycgName != null and !scOycgName.equals('')"> AND a.oycgName LIKE concat('%',#{scOycgName},'%')</if>
		<choose>
			<when test="scOption == 1">AND a.oycgName LIKE concat('%',#{scValue},'%')</when>
			<when test="scOption == 2">AND a.oycgNameEng LIKE concat('%',#{scValue},'%')
			</when>
		</choose>

	</select> -->


	<insert id="insertGroup">

		INSERT INTO oyCodeGroup (
		oycgName
		, oycgDelNy
		) values (
		#{oycgName}
		, 0
		)
		<selectKey resultType="String" keyProperty="oycgSeq" order="AFTER">
			SELECT last_insert_id()
		</selectKey>
	</insert>


	<select id="selectOneGroup" resultMap="resultMapObj">

		SELECT
		oycgSeq
		, oycgName
		, oycgDelNy
		FROM
		oyCodeGroup
		WHERE 1=1
		AND oycgDelNy = 0
		AND oycgSeq =
		#{oycgSeq}

	</select>


	<update id="updateGroup">

		UPDATE
		oyCodeGroup
		SET
		oycgName = #{oycgName}
		WHERE 1=1
		AND oycgSeq = #{oycgSeq}

	</update>

	<select id="selectList" resultMap="resultMapObj">

		SELECT
		a.oycdSeq
		, a.oycdName

		FROM
		oyCode a

		WHERE 1=1
		AND oycdDelNy = 0
		<if test="scOycgSeq != null and !scOycgSeq.equals('')"> AND oycgSeq = #{scOycgSeq}</if>

	</select>


	<insert id="insert">

		INSERT INTO oyCode (
		oycdName
		, oycdDelNy
		, oycgSeq
		)
		values (
		#{oycdName}
		, 0
		,
		#{oycgSeq}
		)

	</insert>


	<select id="selectOne" resultMap="resultMapObj">

		SELECT
		oycdSeq
		, oycdName
		,
		oycdDelNy
		FROM
		oyCode
		WHERE 1=1
		AND oycdDelNy = 0
		AND oycdSeq = #{oycdSeq}

	</select>


	<update id="update">

		UPDATE
		oyCode
		SET
		oycdName = #{oycdName}
		WHERE 1=1
		AND
		oycdSeq = #{oycdSeq}

	</update>


</mapper>
